<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Curricular Interactiva</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #fce4ec;
      padding: 20px;
      color: #333;
    }

    h1 {
      text-align: center;
      color: #ad1457;
      margin-bottom: 30px;
    }

    .cuatrimestre {
      margin-bottom: 40px;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 20px;
    }

    h2 {
      margin-top: 0;
      color: #880e4f;
    }

    h3 {
      margin: 10px 0 5px;
      color: #6a1b9a;
      font-size: 16px;
    }

    .materias {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .materia {
      background-color: #f8bbd0;
      padding: 10px;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: background-color 0.3s ease;
      flex: 1 1 calc(33% - 10px);
      min-width: 180px;
      text-align: center;
    }

    .materia.bloqueada {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .materia.promo {
      background-color: #e1bee7; /* Morado claro */
    }

    .materia.regular {
      background-color: #bbdefb; /* Azul pastel */
    }

    @media (max-width: 600px) {
      .materia {
        flex: 1 1 100%;
      }
    }
  </style>
</head>
<body>
  <h1>Malla Curricular Interactiva</h1>
  <div id="contenedor"></div>

  <script>
    const materias = [
      // 1ﾂｰ Aﾃ前
      { id: 1, nombre: "Introducciﾃｳn al Derecho", c: "1A-1", correlativas: [] },
      { id: 2, nombre: "Historia del Derecho", c: "1A-1", correlativas: [] },
      { id: 3, nombre: "Sociologﾃｭa del Derecho", c: "1A-1", correlativas: [] },
      { id: 4, nombre: "Derecho Polﾃｭtico", c: "1A-2", correlativas: [] },
      { id: 5, nombre: "Introducciﾃｳn a la Filosofﾃｭa", c: "1A-2", correlativas: [] },
      { id: 6, nombre: "Economﾃｭa Polﾃｭtica", c: "1A-2", correlativas: [] },
      { id: 7, nombre: "Expresiﾃｳn Oral y Escrita", c: "1A-2", correlativas: [] },

      // 2ﾂｰ Aﾃ前
      { id: 8, nombre: "Derecho Privado I", c: "2A-1", correlativas: [1,2] },
      { id: 9, nombre: "Derecho Constitucional", c: "2A-1", correlativas: [1,4] },
      { id:10, nombre: "Metodologﾃｭa de la Investigaciﾃｳn", c: "2A-1", correlativas: [] },
      { id:11, nombre: "Derecho Penal Parte Gral", c: "2A-2", correlativas: [8,9] },
      { id:12, nombre: "Derecho Privado II", c: "2A-2", correlativas: [8] },
      { id:13, nombre: "Derecho Pﾃｺblico, Prov. y Mun.", c: "2A-2", correlativas: [9] },
      { id:14, nombre: "Recursos Naturales", c: "2A-2", correlativas: [8,9] },

      // 3ﾂｰ Aﾃ前
      { id:15, nombre: "Derecho Privado III", c: "3A-1", correlativas: [8,9,12] },
      { id:16, nombre: "Derecho Empresario", c: "3A-1", correlativas: [8,12] },
      { id:17, nombre: "Procesal Civil y Comercial", c: "3A-1", correlativas: [8,9] },
      { id:18, nombre: "Derecho Penal Parte Esp.", c: "3A-1", correlativas: [11] },
      { id:19, nombre: "Personas Jurﾃｭdicas", c: "3A-2", correlativas: [8,12,15,16] },
      { id:20, nombre: "Trabajo y Seguridad Social", c: "3A-2", correlativas: [9,16,19] },
      { id:21, nombre: "Filosofﾃｭa del Derecho", c: "3A-2", correlativas: [5] },
      { id:22, nombre: "Mediaciﾃｳn y Mﾃｩt. Alternativos", c: "3A-2", correlativas: [17] },

      // 4ﾂｰ Aﾃ前
      { id:23, nombre: "Derecho Privado IV", c: "4A-1", correlativas: [8,12,15] },
      { id:24, nombre: "Derechos Humanos y Diversidad", c: "4A-1", correlativas: [9,17] },
      { id:25, nombre: "Procesal Penal", c: "4A-1", correlativas: [11,18] },
      { id:26, nombre: "Derecho Administrativo", c: "4A-1", correlativas: [8,12,15,23] },
      { id:27, nombre: "Derecho de la Navegaciﾃｳn", c: "4A-2", correlativas: [8,12,15,20] },
      { id:28, nombre: "Consumidor y Usuario", c: "4A-2", correlativas: [17] },
      { id:29, nombre: "Electiva I", c: "4A-2", correlativas: [] },
      { id:30, nombre: "Taller de Prﾃ｡ctica Profesional", c: "4A-2", correlativas: [17,25] },

      // 5ﾂｰ Aﾃ前
      { id:31, nombre: "Derecho Privado V", c: "5A-1", correlativas: [8,12,15,23] },
      { id:32, nombre: "Minero, Agrario y Energﾃｭa", c: "5A-1", correlativas: [14,23] },
      { id:33, nombre: "Internacional Pﾃｺblico", c: "5A-1", correlativas: [9,24] },
      { id:34, nombre: "Finanzas Pﾃｺblicas", c: "5A-1", correlativas: [6,26] },
      { id:35, nombre: "Concursos y Quiebras", c: "5A-1", correlativas: [16,19,20] },
      { id:36, nombre: "Electiva II", c: "5A-2", correlativas: [] },
      { id:37, nombre: "Internacional Privado", c: "5A-2", correlativas: [19,31] },
      { id:38, nombre: "Procesal Administrativo", c: "5A-2", correlativas: [17,26] },
      { id:39, nombre: "Prﾃ｡ctica Profesional Supervisada", c: "5A-2", correlativas: [30] },
    ];

    let estado = {};

    function cargarEstado() {
      const guardado = localStorage.getItem("estadoMaterias");
      if (guardado) estado = JSON.parse(guardado);
    }

    function guardarEstado() {
      localStorage.setItem("estadoMaterias", JSON.stringify(estado));
    }

    function puedeDesbloquear(m) {
      return m.correlativas.every(id => estado[id] > 0);
    }

    function crearCajaMateria(m) {
      const div = document.createElement("div");
      div.className = "materia";

      const estadoActual = estado[m.id] || 0;
      const desbloqueada = puedeDesbloquear(m) || m.correlativas.length === 0;

      if (!desbloqueada) div.classList.add("bloqueada");
      else {
        if (estadoActual === 1) div.classList.add("promo");
        else if (estadoActual === 2) div.classList.add("regular");

        div.onclick = () => {
          estado[m.id] = (estado[m.id] || 0) + 1;
          if (estado[m.id] > 2) estado[m.id] = 0;
          guardarEstado();
          renderMaterias();
        };
      }

      div.innerText = m.nombre;
      return div;
    }

    function renderMaterias() {
      const contenedor = document.getElementById("contenedor");
      contenedor.innerHTML = "";

      const anios = [...new Set(materias.map(m => m.c.split("A-")[0]))].sort((a, b) => a - b);

      anios.forEach(anio => {
        const bloque = document.createElement("div");
        bloque.className = "cuatrimestre";

        const titulo = document.createElement("h2");
        titulo.innerText = `${anio}ﾂｰ Aﾃｱo`;
        bloque.appendChild(titulo);

        // 1er Cuatrimestre
        const t1 = document.createElement("h3");
        t1.innerText = "沒 1er Cuatrimestre";
        bloque.appendChild(t1);

        const grupo1 = document.createElement("div");
        grupo1.className = "materias";
        materias.filter(m => m.c === `${anio}A-1`).forEach(m => grupo1.appendChild(crearCajaMateria(m)));
        bloque.appendChild(grupo1);

        // 2do Cuatrimestre
        const t2 = document.createElement("h3");
        t2.innerText = "沒 2do Cuatrimestre";
        bloque.appendChild(t2);

        const grupo2 = document.createElement("div");
        grupo2.className = "materias";
        materias.filter(m => m.c === `${anio}A-2`).forEach(m => grupo2.appendChild(crearCajaMateria(m)));
        bloque.appendChild(grupo2);

        contenedor.appendChild(bloque);
      });
    }

    cargarEstado();
    renderMaterias();
  </script>
</body>
</html>
